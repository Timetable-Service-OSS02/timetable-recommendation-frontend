# -*- coding: utf-8 -*-
"""app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1uckb7EdAyP6Qw1ajIzIfZcLSQfTPKdnO
"""

# app.py
import streamlit as st
import pandas as pd

# Core ë ˆí¬ì§€í† ë¦¬ ëª¨ë“ˆ ì„í¬íŠ¸ (ê²½ë¡œ ì„¤ì • í•„ìš”)
# ì‹¤ì œ í˜‘ì—… ì‹œ git submodule ë“±ì„ í†µí•´ core í´ë”ë¥¼ ê°€ì ¸ì™”ë‹¤ê³  ê°€ì •
from core.models import Subject
from core.algorithms import base_strategy, credit_priority_strategy, generate_timetables
from visualizer import draw_timetable

# Streamlit UI ì„¤ì •
st.title("ğŸ“ ì „ëµ íŒ¨í„´ ê¸°ë°˜ ì‹œê°„í‘œ ìë™ ìƒì„±ê¸°")

# ë°ì´í„° ë¡œë“œ (ì‹¤ì œë¡œëŠ” Coreì˜ data_loader ì‚¬ìš© ê¶Œì¥)
df = pd.read_excel("core/subjects.xlsx")

# ì‚¬ì´ë“œë°”/ì…ë ¥ UI
num_subjects = st.number_input("ë“£ê³  ì‹¶ì€ ê³¼ëª© ê°œìˆ˜", min_value=1, max_value=10, step=1)
# ... (ë‚˜ë¨¸ì§€ UI ì½”ë“œ) ...

# ì‹¤í–‰ ë²„íŠ¼ ë¡œì§
if st.button("ì‹œê°„í‘œ ìƒì„±í•˜ê¸°"):
    # ... (ë°ì´í„° í•„í„°ë§ ë° Subject ê°ì²´ ìƒì„±) ...

    subjects = [Subject(row["ê³¼ëª©ëª…"], row["ìš”ì¼"], row["ì‹œì‘ì‹œê°„"], row["ì¢…ë£Œì‹œê°„"], row["í•™ì "], row["ê°•ì˜ì‹¤"])
                for _, row in filtered.iterrows()]

    # ì „ëµ ì„ íƒ ë° ì‹¤í–‰
    strategy = base_strategy # ì˜ˆì‹œ
    results = list(generate_timetables(subjects, num_subjects, strategy))

    # ê²°ê³¼ ì¶œë ¥
    for idx, (tt, score) in enumerate(results):
        st.subheader(f"ì‹œê°„í‘œ {idx+1} (ì ìˆ˜: {score})")
        fig = draw_timetable(tt)
        st.pyplot(fig)